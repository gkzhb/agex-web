{"version":3,"sources":["webpack:///./src/views/AnimeComment.vue?7fc3","webpack:///src/views/AnimeComment.vue","webpack:///./src/views/AnimeComment.vue?0f09","webpack:///./src/views/AnimeComment.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","scopedSlots","_u","key","fn","ref","on","_g","_b","_v","model","value","callback","$$v","commentDialog","expression","commentContent","$event","submitComment","$route","query","getDetailUrl","animeId","_s","animeName","_e","_l","comment","idx","staticRenderFns","components","ATopic","ToTopFab","data","methods","URL","ageDetailUrl","getAnimeComments","toDate","toggleReplies","show","trim","length","$store","dispatch","changePage","page","computed","params","created","component","VBtn","VCard","VCardActions","VCardText","VCardTitle","VContainer","VDialog","VDivider","VIcon","VList","VSpacer","VTextarea"],"mappings":"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","file":"js/comments.d8545133.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('v-container',{staticClass:\"mb-12\"},[_c('v-dialog',{attrs:{\"persistent\":\"\"},scopedSlots:_vm._u([{key:\"activator\",fn:function(ref){\nvar on = ref.on;\nvar attrs = ref.attrs;\nreturn [_c('v-btn',_vm._g(_vm._b({attrs:{\"color\":\"primary\",\"fab\":\"\",\"fixed\":\"\",\"bottom\":\"\",\"right\":\"\"}},'v-btn',attrs,false),on),[_c('v-icon',[_vm._v(\"mdi-plus\")])],1)]}}]),model:{value:(_vm.commentDialog),callback:function ($$v) {_vm.commentDialog=$$v},expression:\"commentDialog\"}},[_c('v-card',[_c('v-card-title',[_c('span',{staticClass:\"headline\"},[_vm._v(\"新留言\")])]),_c('v-card-text',[_c('v-container',[_c('v-textarea',{attrs:{\"label\":\"内容\",\"placeholder\":\"阿巴阿巴~\",\"rows\":\"4\",\"dense\":\"\",\"hide-details\":\"\",\"outlined\":\"\",\"auto-grow\":\"\"},model:{value:(_vm.commentContent),callback:function ($$v) {_vm.commentContent=$$v},expression:\"commentContent\"}})],1)],1),_c('v-card-actions',[_c('v-spacer'),_c('v-btn',{attrs:{\"color\":\"primary darken-1\",\"text\":\"\"},on:{\"click\":function($event){return _vm.submitComment()}}},[_vm._v(\"确定\")]),_c('v-btn',{attrs:{\"color\":\"red darken-1\",\"text\":\"\"},on:{\"click\":function($event){_vm.commentDialog = false}}},[_vm._v(\"取消\")])],1)],1)],1),(this.$route.query.animeName)?_c('h2',{staticClass:\"mb-2\"},[_c('a',{attrs:{\"href\":_vm.getDetailUrl(_vm.animeId)}},[_vm._v(_vm._s(this.$route.query.animeName))])]):_vm._e(),_c('v-list',[_vm._l((_vm.commentList),function(comment,idx){return [(idx != 0)?_c('v-divider',{key:'d-' + idx}):_vm._e(),_c('a-topic',{key:idx,attrs:{\"topic\":comment,\"showTopic\":false}})]})],2),_c('to-top-fab',{attrs:{\"bottom\":false}})],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <v-container class=\"mb-12\">\n    <v-dialog v-model=\"commentDialog\" persistent>\n      <template v-slot:activator=\"{ on, attrs }\">\n        <v-btn color=\"primary\" fab fixed bottom right v-on=\"on\" v-bind=\"attrs\">\n          <v-icon>mdi-plus</v-icon>\n        </v-btn>\n      </template>\n      <v-card>\n        <v-card-title>\n          <span class=\"headline\">新留言</span>\n        </v-card-title>\n        <v-card-text>\n          <v-container>\n            <v-textarea\n              v-model=\"commentContent\"\n              label=\"内容\"\n              placeholder=\"阿巴阿巴~\"\n              rows=\"4\"\n              dense\n              hide-details\n              outlined\n              auto-grow\n            />\n          </v-container>\n        </v-card-text>\n        <v-card-actions>\n          <v-spacer />\n          <v-btn color=\"primary darken-1\" text @click=\"submitComment()\"\n            >确定</v-btn\n          >\n          <v-btn color=\"red darken-1\" text @click=\"commentDialog = false\"\n            >取消</v-btn\n          >\n        </v-card-actions>\n      </v-card>\n    </v-dialog>\n    <h2 v-if=\"this.$route.query.animeName\" class=\"mb-2\">\n      <a :href=\"getDetailUrl(animeId)\">{{ this.$route.query.animeName }}</a>\n    </h2>\n    <v-list>\n      <template v-for=\"(comment, idx) in commentList\">\n        <v-divider :key=\"'d-' + idx\" v-if=\"idx != 0\" />\n        <a-topic :key=\"idx\" :topic=\"comment\" :showTopic=\"false\" />\n      </template>\n    </v-list>\n    <!-- <div class=\"text-center my-4\">\n      <v-pagination v-model=\"page\" :length=\"total\" circle @input=\"changePage\" />\n    </div> -->\n    <to-top-fab :bottom=\"false\" />\n  </v-container>\n</template>\n<script>\nimport { mapGetters } from \"vuex\";\nimport { fromNow, logDebug } from \"../utils/others\";\nimport ATopic from \"../components/ATopic\";\nimport ToTopFab from \"../components/ToTopFab\";\nimport { createTopic, getAnimeComments } from \"../utils/api\";\n\nexport default {\n  components: {\n    ATopic,\n    ToTopFab\n  },\n  data: () => ({\n    commentDialog: false,\n    commentContent: \"\",\n    commentList: [],\n    total: 0,\n    page: 1\n  }),\n  methods: {\n    getDetailUrl(animeId) {\n      return new URL(animeId, this.ageDetailUrl);\n    },\n    getAnimeComments(page = 1) {\n      getAnimeComments(this.animeId, page).then(resp => {\n        this.commentList = resp.articles;\n        /* this.total = Math.ceil(\n          resp.pagination.total / resp.pagination.pageSize\n        ); */\n      });\n    },\n    toDate(t) {\n      return fromNow(t);\n    },\n    toggleReplies(idx) {\n      this.show[idx] = !this.show[idx];\n    },\n    submitComment() {\n      if (this.commentContent.trim().length > 0) {\n        createTopic(this.commentContent, this.animeId).then(resp => {\n          this.$store.dispatch(\"message/success\", \"留言成功\");\n          this.commentDialog = false;\n          logDebug(resp);\n          this.$router.go();\n        });\n      } else {\n        this.$store.dispatch(\"message/error\", \"留言内容不能为空\");\n      }\n    },\n    changePage(page) {\n      this.getAnimeComments(page);\n    }\n  },\n  computed: {\n    ...mapGetters({ ageDetailUrl: \"config/ageDetailUrl\" }),\n    animeId() {\n      return this.$route.params.animeId;\n    }\n  },\n  created() {\n    this.getAnimeComments();\n  }\n};\n</script>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./AnimeComment.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./AnimeComment.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./AnimeComment.vue?vue&type=template&id=85a1151e&\"\nimport script from \"./AnimeComment.vue?vue&type=script&lang=js&\"\nexport * from \"./AnimeComment.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports\n\n/* vuetify-loader */\nimport installComponents from \"!../../node_modules/vuetify-loader/lib/runtime/installComponents.js\"\nimport { VBtn } from 'vuetify/lib/components/VBtn';\nimport { VCard } from 'vuetify/lib/components/VCard';\nimport { VCardActions } from 'vuetify/lib/components/VCard';\nimport { VCardText } from 'vuetify/lib/components/VCard';\nimport { VCardTitle } from 'vuetify/lib/components/VCard';\nimport { VContainer } from 'vuetify/lib/components/VGrid';\nimport { VDialog } from 'vuetify/lib/components/VDialog';\nimport { VDivider } from 'vuetify/lib/components/VDivider';\nimport { VIcon } from 'vuetify/lib/components/VIcon';\nimport { VList } from 'vuetify/lib/components/VList';\nimport { VSpacer } from 'vuetify/lib/components/VGrid';\nimport { VTextarea } from 'vuetify/lib/components/VTextarea';\ninstallComponents(component, {VBtn,VCard,VCardActions,VCardText,VCardTitle,VContainer,VDialog,VDivider,VIcon,VList,VSpacer,VTextarea})\n"],"sourceRoot":""}